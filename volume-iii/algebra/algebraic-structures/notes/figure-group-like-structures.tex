% ============================================================
%  Algebraic Structures — DAG Overview
%  \input{algebraic-dag} into your notes book.
%  Requires in preamble: tikz, xcolor, amsmath, amssymb,
%  graphicx (for \resizebox), and the colour/tikzset definitions
%  from main.tex.
% ============================================================
\clearpage
\thispagestyle{plain}

% ── Node macro ───────────────────────────────────────────────
% Single \vbox per node — eliminates ALL inter-band gaps/ghosts.
% Width set via \nw; scaled later by \resizebox so absolute size
% only needs to be internally consistent.
\newlength{\nw}\setlength{\nw}{3.8cm}

\newcommand{\algnode}[4]{%
  \begin{minipage}{\nw}%
    \setlength{\fboxsep}{3pt}%
    \vbox{\offinterlineskip
      \hbox{\colorbox{#1!85!black}{%
        \parbox[c][1.35em]{\dimexpr\nw-2\fboxsep\relax}{%
          \centering\color{nodetext}\footnotesize\bfseries #2}}}%
      \hbox{\colorbox{#1}{%
        \parbox[c][1.25em]{\dimexpr\nw-2\fboxsep\relax}{%
          \centering\color{sigtext}\scriptsize\ttfamily #3}}}%
      \hbox{\colorbox{#1!50!white}{%
        \parbox{\dimexpr\nw-2\fboxsep\relax}{%
          \vspace{2.5pt}%
          \color{lbltext}\scriptsize\ttfamily\raggedright
          #4%
          \vspace{2.5pt}}}}%
    }%
  \end{minipage}}

% ── Arrow + label styles ──────────────────────────────────────
\tikzset{
  isa/.style    = {-{Stealth[length=5pt]}, draw=arrISA,  thick, solid},
  hasa/.style   = {-{Stealth[length=5pt]}, draw=arrHASA, thick, dashed},
  usesa/.style  = {-{Stealth[length=5pt]}, draw=arrUSES, thick, dotted},
  lbl/.style    = {font=\tiny\ttfamily,   text=lbltext,   inner sep=1pt},
  rellbl/.style = {font=\tiny\itshape,    text=lbltext!80,inner sep=1pt},
}

% ─────────────────────────────────────────────────────────────
%  PAGE CONTENT — kept together with \noindent\vbox so LaTeX
%  won't page-break in the middle of the diagram.
% ─────────────────────────────────────────────────────────────
\begin{center}
  {\large\scshape Group-Like Algebraic Structures}\\[3pt]
  {\scriptsize\ttfamily DAG OVERVIEW\ ·\ IS-A\,/\,HAS-A\,/\,USES-A RELATIONSHIPS}
\end{center}

\vspace{3pt}

% ── Symbol + arrow legend ─────────────────────────────────────
\noindent
\begin{minipage}[t]{0.45\textwidth}
  \scriptsize\ttfamily
  \renewcommand{\arraystretch}{1.3}
  \begin{tabular}{@{}l@{\hspace{7pt}}l@{}}
    $\exists$ & Distinguished element (existentially quantified)\\
    f         & Operation (binary map, closed signature)\\
    $\forall$ & Axiom\,/\,property (universally quantified)\\
  \end{tabular}
\end{minipage}%
\hfill
\begin{minipage}[t]{0.50\textwidth}
  \vspace{3pt}\scriptsize
  \begin{tikzpicture}[baseline=0.3ex]
    \draw[isa]   (0, 0.30)--(0.70, 0.30) node[right,lbl]{\,IS-A\ (extends / adds axiom)};
    \draw[hasa]  (0, 0.00)--(0.70, 0.00) node[right,lbl]{\,HAS-A\ (composed of)};
    \draw[usesa] (0,-0.30)--(0.70,-0.30) node[right,lbl]{\,USES-A\ (external dependency)};
  \end{tikzpicture}
\end{minipage}

\vspace{5pt}\hrule\vspace{5pt}

% ── Main diagram — resized to exactly \textwidth ──────────────
\begin{center}
\resizebox{\textwidth}{!}{%
\begin{tikzpicture}[
    node distance = 0.5cm and 2.4cm,
    every node/.style = {inner sep=0pt, outer sep=2pt},
  ]

  % ── Nodes ──────────────────────────────────────────────────

  \node (set) {\algnode{cSet}{Set}{S}{%
    $\exists$\ elements $a,b,c \in S$}};

  \node (binop) [right=2.8cm of set] {\algnode{cBinop}{Binary Operation}{concept / interface}{%
    $\mathrm{f}$\ $* : A \times A \to A$\\
    $\forall$\ closure:\ $a * b \in A$}};

  \node (magma) [below=of set] {\algnode{cMagma}{Magma}{(A, *)}{%
    $\mathrm{f}$\ $* : A \times A \to A$\\
    $\forall$\ closure}};

  \node (semi) [below=of magma] {\algnode{cSemi}{Semigroup}{(A, *)}{%
    $\forall$\ associativity}};

  \node (monoid) [below=of semi] {\algnode{cMonoid}{Monoid}{(A, *, e)}{%
    $\exists$\ $e$\ (identity element)\\
    $\forall$\ $a * e = e * a = a$}};

  \node (group) [below=of monoid] {\algnode{cGroup}{Group}{$(A,*,e,a^{-1})$}{%
    $\exists$\ $a^{-1}$\ $\forall\,a \in A$\ (inverse)\\
    $\forall$\ $a*a^{-1} = a^{-1}*a = e$}};

  \node (abelian) [below=of group] {\algnode{cAbelian}{Abelian Group}{(A, +, 0, -a)}{%
    $\exists$\ rename:\ $e\!\to\!0$,\ $a^{-1}\!\to\!{-a}$\\
    $\forall$\ $a + b = b + a$\ (commutativity)}};

  \node (ring) [below left=1.0cm and 1.6cm of abelian] {\algnode{cRing}{Ring}{$(A,+,\cdot,0,1)$}{%
    $\mathrm{f}$\ ${\cdot} : A \times A \to A$\\
    $\exists$\ $1$\ (multiplicative identity)\\
    $\forall$\ $a(b+c) = ab+ac$}};

  \node (field) [below right=1.0cm and 1.6cm of abelian] {\algnode{cField}{Field}{$(A,+,\cdot,0,1,a^{-1})$}{%
    $\exists$\ $a^{-1}$\ $\forall\,a\neq 0$\ (mult.\ inv.)\\
    $\forall$\ $a\cdot b = b\cdot a$\ (mult.\ comm.)\\
    $\forall$\ $a\cdot a^{-1} = 1$\ ($a\neq 0$)}};

  \node (vs) [below=1.3cm of abelian] {\algnode{cVS}{Vector Space}{$(V,+,0,-v,F,\cdot)$}{%
    $\mathrm{f}$\ ${\cdot} : F \times V \to V$\ (scalar mult.)\\
    $\forall$\ $a(\mathbf{u}+\mathbf{v}) = a\mathbf{u}+a\mathbf{v}$\\
    $\forall$\ $(a+b)\mathbf{v} = a\mathbf{v}+b\mathbf{v}$\\
    $\forall$\ $1\cdot\mathbf{v}=\mathbf{v}$,\ $ab\cdot\mathbf{v}=a(b\cdot\mathbf{v})$}};

  % ── Arrows ─────────────────────────────────────────────────

  \draw[isa] (set.south) -- (magma.north)
    node[lbl, midway, right=3pt] {IS-A};

  \draw[hasa] (binop.south west) to[out=230, in=20] (magma.north east)
    node[lbl, pos=0.42, above=1pt] {HAS-A};

  \draw[isa] (magma.south) -- (semi.north)
    node[lbl,    midway, right=3pt] {IS-A}
    node[rellbl, midway, left=3pt]  {$+$assoc.};

  \draw[isa] (semi.south) -- (monoid.north)
    node[lbl,    midway, right=3pt] {IS-A}
    node[rellbl, midway, left=3pt]  {$+$identity};

  \draw[isa] (monoid.south) -- (group.north)
    node[lbl,    midway, right=3pt] {IS-A}
    node[rellbl, midway, left=3pt]  {$+$inverse};

  \draw[isa] (group.south) -- (abelian.north)
    node[lbl,    midway, right=3pt] {IS-A}
    node[rellbl, midway, left=3pt]  {$+$comm.};

  \draw[hasa] (abelian.south west) to[out=240, in=85] (ring.north)
    node[lbl,    pos=0.38, left=2pt]  {HAS-A}
    node[rellbl, pos=0.38, left=20pt] {under $+$};

  \draw[hasa] (monoid.west) to[out=180, in=145] (ring.north west)
    node[lbl,    pos=0.48, left=2pt]  {HAS-A}
    node[rellbl, pos=0.48, left=20pt] {under $\cdot$};

  \draw[isa] (ring.north east) to[out=35, in=145] (field.north west)
    node[lbl,    pos=0.5, above=3pt] {IS-A}
    node[rellbl, pos=0.5, below=1pt] {$+$mult.\ inverse};

  \draw[hasa] (abelian.south) to[out=270, in=135] (vs.north west)
    node[lbl,    pos=0.5, right=3pt] {HAS-A}
    node[rellbl, pos=0.5, left=2pt]  {vectors};

  \draw[usesa] (field.south) to[out=260, in=25] (vs.north east)
    node[lbl, pos=0.5, right=3pt] {USES-A};

  \node[rellbl] at ($(field.south)!0.55!(vs.north east)+(0.5,0)$) {scalars};

\end{tikzpicture}%
}% end \resizebox
\end{center}

\vspace{4pt}\hrule\vspace{4pt}

% ── Footer ───────────────────────────────────────────────────
\noindent
\begin{minipage}[t]{0.32\textwidth}
  \scriptsize
  \textbf{\textsc{is-a}}\ \ Strict extension---child satisfies all
  parent axioms plus at least one new constraint.
\end{minipage}%
\hfill
\begin{minipage}[t]{0.32\textwidth}
  \scriptsize
  \textbf{\textsc{has-a}}\ \ Composition---structure contains another
  as a component (e.g.\ Ring \textsc{has-a} Ab.\ Group under $+$
  and Monoid under $\cdot$).
\end{minipage}%
\hfill
\begin{minipage}[t]{0.32\textwidth}
  \scriptsize
  \textbf{\textsc{uses-a}}\ \ External dependency---one structure
  acts on or requires another without inheriting (e.g.\ Vector
  Space \textsc{uses-a} Field for scalars).
\end{minipage}
\clearpage